<!DOCTYPE html>
<html>
  

<head>
  <meta charset="utf-8">
  <meta http-equiv="Content-Language" content="es_ES" />
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <!-- Google tag (gtag.js) -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=G-M146BEZEJV"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'G-M146BEZEJV');
  </script>

  <meta name="description" content="A stream is a sequence of results; learn how to create your own.">
  <title>Creating streams in Dart | Dart es Español</title>

  <!-- Favicon / Touch Icons -->
  <link rel="icon" sizes="64x64" href="/assets/shared/dart/icon/64.png">
  <link href="/assets/img/touch-icon-iphone.png" rel="apple-touch-icon">
  <link href="/assets/img/touch-icon-ipad.png" rel="apple-touch-icon" sizes="152x152">
  <link href="/assets/img/touch-icon-iphone-retina.png" rel="apple-touch-icon" sizes="180x180">
  <link href="/assets/img/touch-icon-ipad-retina.png" rel="apple-touch-icon" sizes="167x167">

  <!-- Twitter Card -->
  <meta name="twitter:card" content="summary" />
  <meta name="twitter:site" content="@dart_lang" />
  <meta name="twitter:title" content="Creating streams in Dart" />
  <meta name="twitter:description" content="A stream is a sequence of results; learn how to create your own." />

  <!-- Open Graph -->
  <meta property="og:title" content="Creating streams in Dart" />
  <meta property="og:description" content="A stream is a sequence of results; learn how to create your own." />
  <meta property="og:url" content="https://dart.esdocu.com/articles/libraries/creating-streams" />
  
  <meta property="og:image" content="https://dart.esdocu.com/assets/shared/dart-logo-for-shares.png?2" />
  
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Google+Sans:wght@400;500;700&display=swap" rel="stylesheet">
  <link href="https://fonts.googleapis.com/css2?family=Google+Sans+Display:wght@400&display=swap" rel="stylesheet">
  <link href="https://fonts.googleapis.com/css2?family=Google+Sans+Mono:wght@400;700&display=swap" rel="stylesheet">
  <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@300;400;500;700&display=swap" rel="stylesheet">
  <link href="https://fonts.googleapis.com/icon?family=Material+Icons&display=swap" rel="stylesheet">
  <script 
    src="https://use.fontawesome.com/releases/v5.15.4/js/all.js"
    data-auto-replace-svg="nest">
  </script>

  <link rel="stylesheet" href="/assets/css/main.css?v=1662143073">
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.6.0/jquery.min.js"
          integrity="sha384-vtXRMe3mGCbOeY7l30aIg8H9p3GdeSe4IFlP6G8JMa7o7lXvnz3GFKzPxzJdPfGK"
          crossorigin="anonymous"
          referrerpolicy="no-referrer"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.16.1/umd/popper.min.js"
          integrity="sha384-9/reFTGAW83EW2RDu2S0VKaIzap3H66lZH81PoYlFhbGU+6BZp6G7niu735Sk7lN"
          crossorigin="anonymous"
          referrerpolicy="no-referrer"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/bootstrap/4.6.1/js/bootstrap.min.js"
          integrity="sha384-VHvPCCyXqtD5DqJeNxl2dtTyhF78xXNXdkwX1CZeRusQfRKp+tA7hAShOK/B/fQ2"
          crossorigin="anonymous"
          referrerpolicy="no-referrer"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/js-cookie/3.0.1/js.cookie.min.js" 
          integrity="sha512-wT7uPE7tOP6w4o28u1DN775jYjHQApdBnib5Pho4RB0Pgd9y7eSkAV1BTqQydupYDB9GBhTcQQzyNMPMV3cAew==" 
          crossorigin="anonymous" 
          referrerpolicy="no-referrer"></script>

  <script src="/assets/js/vendor/code-prettify/prettify.js"></script>
  <script src="/assets/js/vendor/code-prettify/lang-css.js"></script>
  <script src="/assets/js/vendor/code-prettify/lang-dart.js"></script>
  <script src="/assets/js/vendor/code-prettify/lang-yaml.js"></script>
  <script src="/assets/js/os-tabs.js?v=1662143073"></script>
  <script src="/assets/js/utilities.js?v=1662143073"></script>
  <script src="/assets/js/main.js?v=1662143073"></script>

  <script>

(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
})(window,document,'script','//www.google-analytics.com/analytics.js','ga');

ga('create', 'UA-26406144-4', 'auto');
ga('send', 'pageview');

</script>


 </head>

  <body class="default show_banner">
    <section id="cookie-notice">
  <div class="container">
    <p>Google utiliza cookies para prestar sus servicios, personalizar anuncios y analizar el tráfico. 
      Puedes ajustar tus controles de privacidad en cualquier momento en tu 
      <a href="https://myaccount.google.com/data-and-personalization" target="_blank" rel="noopener" class="no-automatic-external">Configuración de Google</a>.
      <a href="https://policies.google.com/technologies/cookies" target="_blank" rel="noopener" class="no-automatic-external">Más información</a>.
    </p>
    <button id="cookie-consent" class="btn btn-primary">Entiendo</button>
  </div>
</section>

    <!-- Google Tag Manager (noscript) -->
<noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-5VSZM5J"
 height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
<!-- End Google Tag Manager (noscript) -->

    <header id="page-header" class="site-header">
  <nav id="mainnav" class="site-header">
  <div id="menu-toggle"><i class="material-icons">menu</i></div>
  <a href="/" class="brand" title="Dart es Español">
    <img src="/assets/img/shared/dart/logo+text/horizontal/white.svg" alt="Dart es Español">
  </a>
  <ul class="navbar">
    <li>
      <a href="/overview" class="nav-link">Overview</a>
    </li>
    <li class="mainnav__get-started">
      <a href="/guides" class="nav-link
        ">
        <span>Docs</span>
      </a>
    </li>
    <li>
      <a href="/community" class="nav-link">Comunidad</a>
    </li>
    <li>
      <a href="/#try-dart" class="nav-link">Probar Dart</a>
    </li>
    <li>
      <a href="/get-dart" class="nav-link">Obtener Dart</a>
    </li>
    <li class="searchfield">
      <form action="/search" class="site-header__search form-inline" id="cse-search-box">
        <input type="hidden" name="cx" value="011220921317074318178:_yy-tmb5t_i">
        <input type="hidden" name="ie" value="UTF-8">
        <input type="hidden" name="hl" value="en">
        <input class="site-header__searchfield form-control search-field" type="search" name="q"
          id="q" autocomplete="off" placeholder="Search" aria-label="Search">
      </form>
    </li>
  </ul>
</nav>

  
</header>
 <div class="banner">
  <p class="banner__text">
    Dart 2.18 ya está disponible con interoperabilidad de Objective-C y Swift y mejoras de networking, la inferencia de tipos y el rendimiento del código asíncrono. <a href="https://medium.com/@mit.mit/dart-2-18-f4b3101f146c">Más información</a><br>
    Los equipos de Flutter y Dart están contratando.
    <a href="https://docs.flutter.dev/jobs">Más información</a>
  </p>
</div> 

    <div id="sidenav" class="">
  <form action="/search/" class="site-header__search form-inline">
    <input class="site-header__searchfield form-control search-field" type="search" name="q"
           id="q" autocomplete="off" placeholder="Search" aria-label="Search">
  </form>

  <div class="site-sidebar">
    <ul class="navbar-nav">
      <li class="nav-item">
        <a href="/overview" class="nav-link">Overview</a>
      </li>
      <li class="nav-item">
        <a href="/community" class="nav-link">Comunidad</a>
      </li>
      <li class="nav-item">
        <a href="https://dartpad.dev" class="nav-link">Probar Dart</a>
      </li>
      <li class="nav-item">
        <a href="/get-dart" class="nav-link">Obtener Dart</a>
      </li>
      <li class="nav-item">
        <a href="/guides" class="nav-link">Docs</a>
      </li>
    </ul>

    <ul class="nav flex-column"><li class="nav-item">
      <a class="nav-link collapsed" data-toggle="collapse" href="#sidenav-1" role="button"
        aria-expanded="false" aria-controls="sidenav-1"
      >Samples & tutorials</a>

      <ul class="nav flex-column flex-nowrap collapse " id="sidenav-1">
        <li class="nav-item">
    <a class="nav-link" href="/samples">Language samples</a>
  </li><li class="nav-item">
    <a class="nav-link collapsable"
      data-toggle="collapse" data-target="#sidenav-1-2"
      href="#sidenav-1-2" role="button"
      aria-expanded="true" aria-controls="sidenav-1-2"
    >Codelabs
    </a>
    <ul class="nav flex-column flex-nowrap collapse show" id="sidenav-1-2">
      <li class="nav-item">
    <a class="nav-link" href="/codelabs">List of Dart codelabs</a>
  </li><li class="nav-item">
    <a class="nav-link" href="/codelabs/dart-cheatsheet">Language cheatsheet</a>
  </li><li class="nav-item">
    <a class="nav-link" href="/codelabs/iterables">Iterable collections</a>
  </li><li class="nav-item">
    <a class="nav-link" href="/codelabs/async-await">Asynchronous programming</a>
  </li><li class="nav-item">
    <a class="nav-link" href="/codelabs/null-safety">Null safety</a>
  </li></ul>
  </li>
<li class="nav-item">
    <a class="nav-link" href="/tutorials">Tutorials</a>
  </li>
</ul>
    </li><li class="nav-item">
      <a class="nav-link collapsed" data-toggle="collapse" href="#sidenav-2" role="button"
        aria-expanded="false" aria-controls="sidenav-2"
      >Language</a>

      <ul class="nav flex-column flex-nowrap collapse " id="sidenav-2">
        <li class="nav-item">
    <a class="nav-link" href="/guides/language/language-tour">Tour</a>
  </li><li class="nav-item">
    <a class="nav-link" href="/guides/language/type-system">Type system</a>
  </li><li class="nav-item">
    <a class="nav-link collapsable collapsed"
      data-toggle="collapse" data-target="#sidenav-2-3"
      href="#sidenav-2-3" role="button"
      aria-expanded="false" aria-controls="sidenav-2-3"
    >Effective Dart
    </a>
    <ul class="nav flex-column flex-nowrap collapse " id="sidenav-2-3">
      <li class="nav-item">
    <a class="nav-link" href="/guides/language/effective-dart">Overview</a>
  </li><li class="nav-item">
    <a class="nav-link" href="/guides/language/effective-dart/style">Style</a>
  </li><li class="nav-item">
    <a class="nav-link" href="/guides/language/effective-dart/documentation">Documentation</a>
  </li><li class="nav-item">
    <a class="nav-link" href="/guides/language/effective-dart/usage">Usage</a>
  </li><li class="nav-item">
    <a class="nav-link" href="/guides/language/effective-dart/design">Design</a>
  </li></ul>
  </li>
<li class="nav-item">
    <a class="nav-link collapsable collapsed"
      data-toggle="collapse" data-target="#sidenav-2-4"
      href="#sidenav-2-4" role="button"
      aria-expanded="false" aria-controls="sidenav-2-4"
    >Coming from ...
    </a>
    <ul class="nav flex-column flex-nowrap collapse " id="sidenav-2-4">
      <li class="nav-item">
    <a class="nav-link" href="/guides/language/coming-from/js-to-dart">JavaScript to Dart</a>
  </li></ul>
  </li>
<li class="nav-item">
    <a class="nav-link" href="/guides/language/extension-methods">Extension methods</a>
  </li><li class="nav-item">
    <a class="nav-link" href="/guides/language/concurrency">Concurrency</a>
  </li><li class="nav-item">
    <a class="nav-link" href="/guides/language/numbers">Numbers</a>
  </li><li class="nav-item">
    <a class="nav-link collapsable collapsed"
      data-toggle="collapse" data-target="#sidenav-2-8"
      href="#sidenav-2-8" role="button"
      aria-expanded="false" aria-controls="sidenav-2-8"
    >Null safety
    </a>
    <ul class="nav flex-column flex-nowrap collapse " id="sidenav-2-8">
      <li class="nav-item">
    <a class="nav-link" href="/null-safety">Overview: Sound null safety</a>
  </li><li class="nav-item">
    <a class="nav-link" href="/null-safety/migration-guide">Migrating to null safety</a>
  </li><li class="nav-item">
    <a class="nav-link" href="/null-safety/understanding-null-safety">Understanding null safety</a>
  </li><li class="nav-item">
    <a class="nav-link" href="/null-safety/unsound-null-safety">Unsound null safety</a>
  </li><li class="nav-item">
    <a class="nav-link" href="/null-safety/faq">FAQ</a>
  </li></ul>
  </li>
<li class="nav-item">
    <a class="nav-link" href="/guides/language/evolution">Evolution</a>
  </li><li class="nav-item">
    <a class="nav-link" href="/guides/language/spec">Specification</a>
  </li>
</ul>
    </li><li class="nav-item">
      <a class="nav-link active" data-toggle="collapse" href="#sidenav-3" role="button"
        aria-expanded="true" aria-controls="sidenav-3"
      >Core libraries</a>

      <ul class="nav flex-column flex-nowrap collapse show" id="sidenav-3">
        <li class="nav-item">
    <a class="nav-link" href="/guides/libraries">Overview</a>
  </li><li class="nav-item">
    <a class="nav-link" href="/guides/libraries/library-tour">Tour</a>
  </li><li class="nav-item">
    <a class="nav-link active collapsable"
      data-toggle="collapse" data-target="#sidenav-3-3"
      href="#sidenav-3-3" role="button"
      aria-expanded="true" aria-controls="sidenav-3-3"
    >Articles
    </a>
    <ul class="nav flex-column flex-nowrap collapse show" id="sidenav-3-3">
      <li class="nav-item">
    <a class="nav-link" href="/articles/libraries/dart-io">Intro to dart:io</a>
  </li><li class="nav-item">
    <a class="nav-link active" href="/articles/libraries/creating-streams">Creating streams</a>
  </li></ul>
  </li>

</ul>
    </li><li class="nav-item">
      <a class="nav-link collapsed" data-toggle="collapse" href="#sidenav-4" role="button"
        aria-expanded="false" aria-controls="sidenav-4"
      >Packages</a>

      <ul class="nav flex-column flex-nowrap collapse " id="sidenav-4">
        <li class="nav-item">
    <a class="nav-link" href="/guides/packages">How to use packages</a>
  </li><li class="nav-item">
    <a class="nav-link" href="/guides/libraries/useful-libraries">Commonly used packages</a>
  </li><li class="nav-item">
    <a class="nav-link" href="/guides/libraries/create-library-packages">Creating packages</a>
  </li><li class="nav-item">
    <a class="nav-link" href="/tools/pub/publishing">Publishing packages</a>
  </li><li class="nav-item">
    <a class="nav-link" href="/guides/libraries/writing-package-pages">Writing package pages</a>
  </li><li class="nav-item">
    <a class="nav-link collapsable collapsed"
      data-toggle="collapse" data-target="#sidenav-4-6"
      href="#sidenav-4-6" role="button"
      aria-expanded="false" aria-controls="sidenav-4-6"
    >Package reference
    </a>
    <ul class="nav flex-column flex-nowrap collapse " id="sidenav-4-6">
      <li class="nav-item">
    <a class="nav-link" href="/tools/pub/dependencies">Dependencies</a>
  </li><li class="nav-item">
    <a class="nav-link" href="/tools/pub/glossary">Glossary</a>
  </li><li class="nav-item">
    <a class="nav-link" href="/tools/pub/package-layout">Package layout conventions</a>
  </li><li class="nav-item">
    <a class="nav-link" href="/tools/pub/environment-variables">Pub environment variables</a>
  </li><li class="nav-item">
    <a class="nav-link" href="/tools/pub/pubspec">Pubspec file</a>
  </li><li class="nav-item">
    <a class="nav-link" href="/tools/pub/troubleshoot">Troubleshooting pub</a>
  </li><li class="nav-item">
    <a class="nav-link" href="/tools/pub/verified-publishers">Verified publishers</a>
  </li><li class="nav-item">
    <a class="nav-link" href="/tools/pub/versioning">Versioning</a>
  </li></ul>
  </li>

</ul>
    </li><li class="nav-item">
      <a class="nav-link collapsed" data-toggle="collapse" href="#sidenav-5" role="button"
        aria-expanded="false" aria-controls="sidenav-5"
      >Development</a>

      <ul class="nav flex-column flex-nowrap collapse " id="sidenav-5">
        <li class="nav-item">
    <a class="nav-link" href="/codelabs/async-await">Futures, async, await</a>
  </li><li class="nav-item">
    <a class="nav-link" href="/tutorials/language/streams">Streams</a>
  </li><li class="nav-item">
    <a class="nav-link" href="/guides/json">JSON</a>
  </li><li class="nav-item">
    <a class="nav-link collapsable collapsed"
      data-toggle="collapse" data-target="#sidenav-5-4"
      href="#sidenav-5-4" role="button"
      aria-expanded="false" aria-controls="sidenav-5-4"
    >Interoperability
    </a>
    <ul class="nav flex-column flex-nowrap collapse " id="sidenav-5-4">
      <li class="nav-item">
    <a class="nav-link" href="/guides/libraries/c-interop">C interop</a>
  </li><li class="nav-item">
    <a class="nav-link" href="/guides/libraries/objective-c-interop">Objective-C and Swift interop</a>
  </li><li class="nav-item">
    <a class="nav-link" href="/web/js-interop">JavaScript interop</a>
  </li></ul>
  </li>
<li class="nav-item">
    <a class="nav-link" href="/guides/google-apis">Google APIs</a>
  </li><li class="nav-item">
    <a class="nav-link" href="/multiplatform-apps">Multi-platform apps</a>
  </li><li class="nav-item">
    <a class="nav-link collapsable collapsed"
      data-toggle="collapse" data-target="#sidenav-5-7"
      href="#sidenav-5-7" role="button"
      aria-expanded="false" aria-controls="sidenav-5-7"
    >Command-line & server apps
    </a>
    <ul class="nav flex-column flex-nowrap collapse " id="sidenav-5-7">
      <li class="nav-item">
    <a class="nav-link" href="/server">Overview</a>
  </li><li class="nav-item">
    <a class="nav-link" href="/tutorials/server/get-started">Get started</a>
  </li><li class="nav-item">
    <a class="nav-link" href="/tutorials/server/cmdline">Write command-line apps</a>
  </li><li class="nav-item">
    <a class="nav-link" href="/tutorials/server/httpserver">Write HTTP servers</a>
  </li><li class="nav-item">
    <a class="nav-link" href="/server/libraries">Libraries and packages</a>
  </li><li class="nav-item">
    <a class="nav-link" href="/server/google-cloud">Google Cloud</a>
  </li></ul>
  </li>
<li class="nav-item">
    <a class="nav-link collapsable collapsed"
      data-toggle="collapse" data-target="#sidenav-5-8"
      href="#sidenav-5-8" role="button"
      aria-expanded="false" aria-controls="sidenav-5-8"
    >Web apps
    </a>
    <ul class="nav flex-column flex-nowrap collapse " id="sidenav-5-8">
      <li class="nav-item">
    <a class="nav-link" href="/web">Overview</a>
  </li><li class="nav-item">
    <a class="nav-link" href="/tutorials/web/get-started">Get started</a>
  </li><li class="nav-item">
    <a class="nav-link" href="/tutorials/web/fetch-data">Fetch data dynamically</a>
  </li><li class="nav-item">
    <a class="nav-link collapsable collapsed"
      data-toggle="collapse" data-target="#sidenav-5-8-4"
      href="#sidenav-5-8-4" role="button"
      aria-expanded="false" aria-controls="sidenav-5-8-4"
    >Low-level web programming
    </a>
    <ul class="nav flex-column flex-nowrap collapse " id="sidenav-5-8-4">
      <li class="nav-item">
    <a class="nav-link" href="/tutorials/web/low-level-html/connect-dart-html">Connect Dart & HTML</a>
  </li>
  <li class="nav-item">
    <a class="nav-link" href="/tutorials/web/low-level-html/add-elements">Add elements to the DOM</a>
  </li>
  <li class="nav-item">
    <a class="nav-link" href="/tutorials/web/low-level-html/remove-elements">Remove DOM elements</a>
  </li>
  </ul>
  </li>
<li class="nav-item">
    <a class="nav-link" href="/web/deployment">Deployment</a>
  </li><li class="nav-item">
    <a class="nav-link" href="/web/libraries">Libraries and packages</a>
  </li></ul>
  </li>

</ul>
    </li><li class="nav-item">
      <a class="nav-link collapsed" data-toggle="collapse" href="#sidenav-6" role="button"
        aria-expanded="false" aria-controls="sidenav-6"
      >Tools & techniques</a>

      <ul class="nav flex-column flex-nowrap collapse " id="sidenav-6">
        <li class="nav-item">
    <a class="nav-link" href="/tools">Overview</a>
  </li><li class="nav-item">
    <a class="nav-link collapsable collapsed"
      data-toggle="collapse" data-target="#sidenav-6-2"
      href="#sidenav-6-2" role="button"
      aria-expanded="false" aria-controls="sidenav-6-2"
    >Editors & debuggers
    </a>
    <ul class="nav flex-column flex-nowrap collapse " id="sidenav-6-2">
      <li class="nav-item">
    <a class="nav-link" href="/tools/jetbrains-plugin">IntelliJ & Android Studio</a>
  </li><li class="nav-item">
    <a class="nav-link" href="/tools/vs-code">VS Code</a>
  </li><li class="nav-item">
    <a class="nav-link" href="/tools/dart-devtools">Dart DevTools</a>
  </li><li class="nav-item">
    <a class="nav-link" href="/tools/dartpad">DartPad</a>
  </li></ul>
  </li>
<li class="nav-item">
    <a class="nav-link collapsable collapsed"
      data-toggle="collapse" data-target="#sidenav-6-3"
      href="#sidenav-6-3" role="button"
      aria-expanded="false" aria-controls="sidenav-6-3"
    >Command-line tools
    </a>
    <ul class="nav flex-column flex-nowrap collapse " id="sidenav-6-3">
      <li class="nav-item">
    <a class="nav-link collapsable"
      data-toggle="collapse" data-target="#sidenav-6-3-1"
      href="#sidenav-6-3-1" role="button"
      aria-expanded="true" aria-controls="sidenav-6-3-1"
    >Dart SDK
    </a>
    <ul class="nav flex-column flex-nowrap collapse show" id="sidenav-6-3-1">
      <li class="nav-item">
    <a class="nav-link" href="/tools/sdk">Overview</a>
  </li>
  <li class="nav-item">
    <a class="nav-link" href="/tools/dart-tool">dart</a>
  </li>
  <li class="nav-item">
    <a class="nav-link" href="/tools/dart-analyze">dart analyze</a>
  </li>
  <li class="nav-item">
    <a class="nav-link" href="/tools/dart-compile">dart compile</a>
  </li>
  <li class="nav-item">
    <a class="nav-link" href="/tools/dart-create">dart create</a>
  </li>
  <li class="nav-item">
    <a class="nav-link" href="/tools/dart-doc">dart doc</a>
  </li>
  <li class="nav-item">
    <a class="nav-link" href="/tools/dart-fix">dart fix</a>
  </li>
  <li class="nav-item">
    <a class="nav-link" href="/tools/dart-format">dart format</a>
  </li>
  <li class="nav-item">
    <a class="nav-link" href="/tools/pub/cmd">dart pub</a>
  </li>
  <li class="nav-item">
    <a class="nav-link" href="/tools/dart-run">dart run</a>
  </li>
  <li class="nav-item">
    <a class="nav-link" href="/tools/dart-test">dart test</a>
  </li>
  <li class="nav-item">
    <a class="nav-link" href="/tools/dartaotruntime">dartaotruntime</a>
  </li>
  <li class="nav-item">
    <a class="nav-link" href="/tools/experiment-flags">Experiment flags</a>
  </li>
  </ul>
  </li>
<li class="nav-item">
    <a class="nav-link collapsable"
      data-toggle="collapse" data-target="#sidenav-6-3-2"
      href="#sidenav-6-3-2" role="button"
      aria-expanded="true" aria-controls="sidenav-6-3-2"
    >Other command-line tools
    </a>
    <ul class="nav flex-column flex-nowrap collapse show" id="sidenav-6-3-2">
      <li class="nav-item">
    <a class="nav-link" href="/tools/build_runner">build_runner</a>
  </li>
  <li class="nav-item">
    <a class="nav-link" href="/tools/webdev">webdev</a>
  </li>
  </ul>
  </li>
</ul>
  </li>
<li class="nav-item">
    <a class="nav-link collapsable collapsed"
      data-toggle="collapse" data-target="#sidenav-6-4"
      href="#sidenav-6-4" role="button"
      aria-expanded="false" aria-controls="sidenav-6-4"
    >Managing source code
    </a>
    <ul class="nav flex-column flex-nowrap collapse " id="sidenav-6-4">
      <li class="nav-item">
    <a class="nav-link" href="/guides/language/formatting">Formatting code</a>
  </li><li class="nav-item">
    <a class="nav-link" href="/guides/libraries/private-files">What not to commit</a>
  </li></ul>
  </li>
<li class="nav-item">
    <a class="nav-link collapsable collapsed"
      data-toggle="collapse" data-target="#sidenav-6-5"
      href="#sidenav-6-5" role="button"
      aria-expanded="false" aria-controls="sidenav-6-5"
    >Static analysis
    </a>
    <ul class="nav flex-column flex-nowrap collapse " id="sidenav-6-5">
      <li class="nav-item">
    <a class="nav-link" href="/guides/language/analysis-options">Customizing static analysis</a>
  </li><li class="nav-item">
    <a class="nav-link" href="/guides/language/sound-problems">Fixing common type problems</a>
  </li><li class="nav-item">
    <a class="nav-link" href="/tools/diagnostic-messages">Diagnostic messages</a>
  </li><li class="nav-item">
    <a class="nav-link" href="/tools/linter-rules">Linter rules</a>
  </li></ul>
  </li>
<li class="nav-item">
    <a class="nav-link collapsable collapsed"
      data-toggle="collapse" data-target="#sidenav-6-6"
      href="#sidenav-6-6" role="button"
      aria-expanded="false" aria-controls="sidenav-6-6"
    >Testing & optimization
    </a>
    <ul class="nav flex-column flex-nowrap collapse " id="sidenav-6-6">
      <li class="nav-item">
    <a class="nav-link" href="/guides/testing">Testing</a>
  </li><li class="nav-item">
    <a class="nav-link" href="/web/debugging">Debugging web apps</a>
  </li></ul>
  </li>

</ul>
    </li><li class="nav-item">
      <a class="nav-link collapsed" data-toggle="collapse" href="#sidenav-7" role="button"
        aria-expanded="false" aria-controls="sidenav-7"
      >Resources</a>

      <ul class="nav flex-column flex-nowrap collapse " id="sidenav-7">
        <li class="nav-item">
    <a class="nav-link" href="/resources">Overview</a>
  </li><li class="nav-item">
    <a class="nav-link" href="/resources/books">Books</a>
  </li><li class="nav-item">
    <a class="nav-link" href="/resources/dartpad-best-practices">DartPad in tutorials: Best practices</a>
  </li><li class="nav-item">
    <a class="nav-link" href="/code-of-conduct">Code of conduct</a>
  </li><li class="nav-item">
    <a class="nav-link" href="/faq">FAQ</a>
  </li><li class="nav-item">
    <a class="nav-link collapsable collapsed"
      data-toggle="collapse" data-target="#sidenav-7-6"
      href="#sidenav-7-6" role="button"
      aria-expanded="false" aria-controls="sidenav-7-6"
    >History
    </a>
    <ul class="nav flex-column flex-nowrap collapse " id="sidenav-7-6">
      <li class="nav-item">
    <a class="nav-link" href="/dart-2">Migrating to Dart&nbsp;2</a>
  </li></ul>
  </li>
<li class="nav-item">
    <a class="nav-link" href="/resources/videos">Videos</a>
  </li>
</ul>
    </li><li class="nav-item">
      <a class="nav-link " data-toggle="collapse" href="#sidenav-8" role="button"
        aria-expanded="true" aria-controls="sidenav-8"
      >Related sites</a>

      <ul class="nav flex-column flex-nowrap collapse show" id="sidenav-8">
        <li class="nav-item">
    <a class="nav-link" href="https://api.dart.dev" target="_blank" rel="noopener">API reference<span class="material-icons md-24">
        open_in_new
      </span></a>
  </li><li class="nav-item">
    <a class="nav-link" href="https://medium.com/dartlang" target="_blank" rel="noopener">Blog<span class="material-icons md-24">
        open_in_new
      </span></a>
  </li><li class="nav-item">
    <a class="nav-link" href="https://dartpad.dev" target="_blank" rel="noopener">DartPad (online editor)<span class="material-icons md-24">
        open_in_new
      </span></a>
  </li><li class="nav-item">
    <a class="nav-link" href="https://flutter.dev" target="_blank" rel="noopener">Flutter<span class="material-icons md-24">
        open_in_new
      </span></a>
  </li><li class="nav-item">
    <a class="nav-link" href="https://pub.dev" target="_blank" rel="noopener">Package site<span class="material-icons md-24">
        open_in_new
      </span></a>
  </li>
</ul>
    </li></ul>

  </div>
</div>

    <main id="page-content">
      







<div id="site-toc--side" class="site-toc ">
  <header class="site-toc__title">
    Contents
    <button type="button" class="btn site-toc--button__page-top" aria-label="Page top"></button>
    
  </header>
  <ul id="toc" class="section-nav">
<li class="toc-entry nav-item toc-h2"><a class="nav-link" href="#transforming-an-existing-stream">Transforming an existing stream</a></li>
<li class="toc-entry nav-item toc-h2"><a class="nav-link" href="#creating-a-stream-from-scratch">Creating a stream from scratch</a></li>
<li class="toc-entry nav-item toc-h2"><a class="nav-link" href="#using-a-streamcontroller">Using a StreamController</a>
<ul class="nav">
<li class="toc-entry nav-item toc-h3"><a class="nav-link" href="#waiting-for-a-subscription">Waiting for a subscription</a></li>
<li class="toc-entry nav-item toc-h3"><a class="nav-link" href="#honoring-the-pause-state">Honoring the pause state</a></li>
</ul>
</li>
<li class="toc-entry nav-item toc-h2"><a class="nav-link" href="#final-hints">Final hints</a></li>
</ul>
</div>


      <article>
        <div class="content">
          

          <div>
            <div id="page-github-links" class="btn-group" aria-label="Page GitHub links" role="group">
  <a href="https://github.com/dart-lang/site-www/tree/main/src/_articles/libraries/creating-streams.md" class="btn no-automatic-external" title="View page source" target="_blank" rel="noopener">
    <i class="fas fa-file-alt fa-sm"></i>
  </a>
  <a href="https://github.com/dart-lang/site-www/issues/new?template=1_page_issue.yml&title=[PAGE ISSUE]: 'Creating streams in Dart'&page-url=https://dart.esdocu.com/articles/libraries/creating-streams&page-source=https://github.com/dart-lang/site-www/tree/main/src/_articles/libraries/creating-streams.md" class="btn no-automatic-external" title="Report an issue with this page"
    target="_blank" rel="noopener">
    <i class="fas fa-bug fa-sm"></i>
  </a>
</div>

            <h1>Creating streams in Dart</h1>
          </div>
          







<div id="site-toc--inline" class="site-toc ">
  <header class="site-toc__title">
    Contents
    <button type="button" class="btn site-toc--button__page-top" aria-label="Page top"></button>
    
  </header>
  <ul id="toc" class="section-nav">
<li class="toc-entry toc-h2"><a href="#transforming-an-existing-stream">Transforming an existing stream</a></li>
<li class="toc-entry toc-h2"><a href="#creating-a-stream-from-scratch">Creating a stream from scratch</a></li>
<li class="toc-entry toc-h2"><a href="#using-a-streamcontroller">Using a StreamController</a>
<ul>
<li class="toc-entry toc-h3"><a href="#waiting-for-a-subscription">Waiting for a subscription</a></li>
<li class="toc-entry toc-h3"><a href="#honoring-the-pause-state">Honoring the pause state</a></li>
</ul>
</li>
<li class="toc-entry toc-h2"><a href="#final-hints">Final hints</a></li>
</ul>
</div>


          <style>
.comment {color:red;}
</style>

<p><em>Written by Lasse Nielsen <br>
April 2013 (updated May 2021)</em></p>

<p>The dart:async library contains two types
that are important for many Dart APIs:
<a href="https://api.dart.dev/stable/dart-async/Stream-class.html">Stream</a> and
<a href="https://api.dart.dev/stable/dart-async/Future-class.html">Future.</a>
Where a Future represents the result of a single computation,
a stream is a <em>sequence</em> of results.
You listen on a stream to get notified of the results
(both data and errors)
and of the stream shutting down.
You can also pause while listening or stop listening to the stream
before it is complete.</p>

<p>But this article is not about <em>using</em> streams.
It’s about creating your own streams.
You can create streams in a few ways:</p>

<ul>
  <li>Transforming existing streams.</li>
  <li>Creating a stream from scratch by using an <code class="language-plaintext highlighter-rouge">async*</code> function.</li>
  <li>Creating a stream by using a <code class="language-plaintext highlighter-rouge">StreamController</code>.</li>
</ul>

<p>This article shows the code for each approach
and gives tips to help you implement your stream correctly.</p>

<p>For help on using streams, see
<a href="/tutorials/language/streams">Asynchronous Programming: Streams</a>.</p>

<h2 id="transforming-an-existing-stream">
<a class="anchor" href="#transforming-an-existing-stream" aria-hidden="true"><span class="octicon octicon-link"></span></a>Transforming an existing stream</h2>

<p>The common case for creating streams is that you already have a stream,
and you want to create a new stream based on the original stream’s events.
For example you might have a stream of bytes that
you want to convert to a stream of strings by UTF-8 decoding the input.
The most general approach is to create a new stream that
waits for events on the original stream and then
outputs new events. Example:</p>

<div class="code-excerpt">
<div class="code-excerpt__code"><pre class="prettyprint lang-dart">/// Splits a stream of consecutive strings into lines.
///
/// The input string is provided in smaller chunks through
/// the `source` stream.
Stream&lt;String&gt; lines(Stream&lt;String&gt; source) async* {
  // Stores any partial line from the previous chunk.
  var partial = '';
  // Wait until a new chunk is available, then process it.
  await for (final chunk in source) {
    var lines = chunk.split('\n');
    lines[0] = partial + lines[0]; // Prepend partial line.
    partial = lines.removeLast(); // Remove new partial line.
    for (final line in lines) {
      yield line; // Add lines to output stream.
    }
  }
  // Add final partial line to output stream, if any.
  if (partial.isNotEmpty) yield partial;
}</pre></div>
</div>

<p>For many common transformations,
you can use <code class="language-plaintext highlighter-rouge">Stream</code>-supplied transforming methods
such as <code class="language-plaintext highlighter-rouge">map()</code>, <code class="language-plaintext highlighter-rouge">where()</code>, <code class="language-plaintext highlighter-rouge">expand()</code>, and <code class="language-plaintext highlighter-rouge">take()</code>.</p>

<p>For example, assume you have a stream, <code class="language-plaintext highlighter-rouge">counterStream</code>,
that emits an increasing counter every second.
Here’s how it might be implemented:</p>

<div class="code-excerpt">
<div class="code-excerpt__code"><pre class="prettyprint lang-dart">var counterStream =
    Stream&lt;int&gt;.periodic(const Duration(seconds: 1), (x) =&gt; x).take(15);</pre></div>
</div>

<p>To quickly see the events, you can use code like this:</p>

<div class="code-excerpt">
<div class="code-excerpt__code"><pre class="prettyprint lang-dart">counterStream.forEach(print); // Print an integer every second, 15 times.</pre></div>
</div>

<p>To transform the stream events, you can invoke a transforming method
such as <code class="language-plaintext highlighter-rouge">map()</code> on the stream before listening to it.
The method returns a new stream.</p>

<div class="code-excerpt">
<div class="code-excerpt__code"><pre class="prettyprint lang-dart">// Double the integer in each event.
var doubleCounterStream = counterStream.map((int x) =&gt; x * 2);
doubleCounterStream.forEach(print);</pre></div>
</div>

<p>Instead of <code class="language-plaintext highlighter-rouge">map()</code>, you could use any other transforming method,
such as the following:</p>

<div class="code-excerpt">
<div class="code-excerpt__code"><pre class="prettyprint lang-dart">.where((int x) =&gt; x.isEven) // Retain only even integer events.
.expand((var x) =&gt; [x, x]) // Duplicate each event.
.take(5) // Stop after the first five events.</pre></div>
</div>

<p>Often, a transforming method is all you need.
However, if you need even more control over the transformation,
you can specify a
<a href="https://api.dart.dev/stable/dart-async/StreamTransformer-class.html">StreamTransformer</a>
with <code class="language-plaintext highlighter-rouge">Stream</code>’s <code class="language-plaintext highlighter-rouge">transform()</code> method.
The platform libraries provide stream transformers for many common tasks.
For example, the following code uses the <code class="language-plaintext highlighter-rouge">utf8.decoder</code> and <code class="language-plaintext highlighter-rouge">LineSplitter</code>
transformers provided by the dart:convert library.</p>

<div class="code-excerpt">
<div class="code-excerpt__code"><pre class="prettyprint lang-dart">Stream&lt;List&lt;int&gt;&gt; content = File('someFile.txt').openRead();
List&lt;String&gt; lines = await content
    .transform(utf8.decoder)
    .transform(const LineSplitter())
    .toList();</pre></div>
</div>

<h2 id="creating-a-stream-from-scratch">
<a class="anchor" href="#creating-a-stream-from-scratch" aria-hidden="true"><span class="octicon octicon-link"></span></a>Creating a stream from scratch</h2>

<p>One way to create a new stream is with
an asynchronous generator (<code class="language-plaintext highlighter-rouge">async*</code>) function.
The stream is created when the function is called,
and the function’s body starts running when the stream is listened to.
When the function returns, the stream closes.
Until the function returns, it can emit events on the stream by
using <code class="language-plaintext highlighter-rouge">yield</code> or <code class="language-plaintext highlighter-rouge">yield*</code> statements.</p>

<p>Here’s a primitive example that emits numbers at regular intervals:</p>

<div class="code-excerpt">
<div class="code-excerpt__code"><pre class="prettyprint lang-dart">Stream&lt;int&gt; timedCounter(Duration interval, [int? maxCount]) async* {
  int i = 0;
  while (true) {
    await Future.delayed(interval);
    yield i++;
    if (i == maxCount) break;
  }
}</pre></div>
</div>

<p>This function returns a <code class="language-plaintext highlighter-rouge">Stream</code>.
When that stream is listened to, the body starts running.
It repeatedly delays for the requested interval and then yields the next number.
If the <code class="language-plaintext highlighter-rouge">maxCount</code> parameter is omitted, there is no stop condition on the loop,
so the stream outputs increasingly larger numbers forever -
or until the listener cancels its subscription.</p>

<p>When the listener cancels
(by invoking <code class="language-plaintext highlighter-rouge">cancel()</code> on the <code class="language-plaintext highlighter-rouge">StreamSubscription</code>
object returned by the <code class="language-plaintext highlighter-rouge">listen()</code> method),
then the next time the body reaches a <code class="language-plaintext highlighter-rouge">yield</code> statement,
the <code class="language-plaintext highlighter-rouge">yield</code> instead acts as a <code class="language-plaintext highlighter-rouge">return</code> statement.
Any enclosing <code class="language-plaintext highlighter-rouge">finally</code> block is executed,
and the function exits.
If the function attempts to yield a value before exiting,
that fails and acts as a return.</p>

<p>When the function finally exits, the future returned by
the <code class="language-plaintext highlighter-rouge">cancel()</code> method completes.
If the function exits with an error, the future completes with that error;
otherwise, it completes with <code class="language-plaintext highlighter-rouge">null</code>.</p>

<p>Another, more useful example is a function that converts
a sequence of futures to a stream:</p>

<div class="code-excerpt">
<div class="code-excerpt__code"><pre class="prettyprint lang-dart">Stream&lt;T&gt; streamFromFutures&lt;T&gt;(Iterable&lt;Future&lt;T&gt;&gt; futures) async* {
  for (final future in futures) {
    var result = await future;
    yield result;
  }
}</pre></div>
</div>

<p>This function asks the <code class="language-plaintext highlighter-rouge">futures</code> iterable for a new future,
waits for that future, emits the resulting value, and then loops.
If a future completes with an error, then the stream completes with that error.</p>

<p>It’s rare to have an <code class="language-plaintext highlighter-rouge">async*</code> function building a stream from nothing.
It needs to get its data from somewhere,
and most often that somewhere is another stream.
In some cases, like the sequence of futures above,
the data comes from other asynchronous event sources.
In many cases, however, an <code class="language-plaintext highlighter-rouge">async*</code> function is too simplistic to
easily handle multiple data sources.
That’s where the <code class="language-plaintext highlighter-rouge">StreamController</code> class comes in.</p>

<h2 id="using-a-streamcontroller">
<a class="anchor" href="#using-a-streamcontroller" aria-hidden="true"><span class="octicon octicon-link"></span></a>Using a StreamController</h2>

<p>If the events of your stream comes from different parts of your program,
and not just from a stream or futures that can traversed by an <code class="language-plaintext highlighter-rouge">async</code> function,
then use a
<a href="https://api.dart.dev/stable/dart-async/StreamController-class.html">StreamController</a>
to create and populate the stream.</p>

<p>A <code class="language-plaintext highlighter-rouge">StreamController</code> gives you a new stream
and a way to add events to the stream at any point, and from anywhere.
The stream has all the logic necessary to handle listeners and pausing.
You return the stream and keep the controller to yourself.</p>

<p>The following example
(from <a href="https://github.com/dart-lang/site-www/blob/main/examples/misc/lib/articles/creating-streams/stream_controller_bad.dart">stream_controller_bad.dart</a>)
shows a basic, though flawed, usage of <code class="language-plaintext highlighter-rouge">StreamController</code>
to implement the <code class="language-plaintext highlighter-rouge">timedCounter()</code> function from the previous examples.
This code creates a stream to return,
and then feeds data into it based on timer events,
which are neither futures nor stream events.</p>

<pre class="prettyprint lang-dart bad"><code>// NOTE: This implementation is FLAWED!
// It starts before it has subscribers, and it doesn't implement pause.
Stream&lt;int&gt; timedCounter(Duration interval, [int? maxCount]) {
  var controller = StreamController&lt;int&gt;();
  int counter = 0;
  void tick(Timer timer) {
    counter++;
    controller.add(counter); // Ask stream to send counter values as event.
    if (maxCount != null &amp;&amp; counter &gt;= maxCount) {
      timer.cancel();
      controller.close(); // Ask stream to shut down and tell listeners.
    }
  }

  Timer.periodic(interval, tick); // BAD: Starts before it has subscribers.
  return controller.stream;
}</code></pre>

<p>As before, you can use the stream returned by <code class="language-plaintext highlighter-rouge">timedCounter()</code> like this:</p>

<div class="code-excerpt">
<div class="code-excerpt__code"><pre class="prettyprint lang-dart">var counterStream = timedCounter(const Duration(seconds: 1), 15);
counterStream.listen(print); // Print an integer every second, 15 times.</pre></div>
</div>

<p>This implementation of <code class="language-plaintext highlighter-rouge">timedCounter()</code> has
a couple of problems:</p>

<ul>
  <li>It starts producing events before it has subscribers.</li>
  <li>It keeps producing events even if the subscriber requests a pause.</li>
</ul>

<p>As the next sections show,
you can fix both of these problems by specifying
callbacks such as <code class="language-plaintext highlighter-rouge">onListen</code> and <code class="language-plaintext highlighter-rouge">onPause</code>
when creating the <code class="language-plaintext highlighter-rouge">StreamController</code>.</p>

<h3 id="waiting-for-a-subscription">
<a class="anchor" href="#waiting-for-a-subscription" aria-hidden="true"><span class="octicon octicon-link"></span></a>Waiting for a subscription</h3>

<p>As a rule, streams should wait for subscribers before starting their work.
An <code class="language-plaintext highlighter-rouge">async*</code> function does this automatically,
but when using a <code class="language-plaintext highlighter-rouge">StreamController</code>,
you are in full control and can add events even when you shouldn’t.
When a stream has no subscriber,
its <code class="language-plaintext highlighter-rouge">StreamController</code> buffers events,
which can lead to a memory leak
if the stream never gets a subscriber.</p>

<p>Try changing the code that uses the stream to the following:</p>

<div class="code-excerpt">
<div class="code-excerpt__code"><pre class="prettyprint lang-dart">void listenAfterDelay() async {
  var counterStream = timedCounter(const Duration(seconds: 1), 15);
  await Future.delayed(const Duration(seconds: 5));

  // After 5 seconds, add a listener.
  await for (final n in counterStream) {
    print(n); // Print an integer every second, 15 times.
  }
}</pre></div>
</div>

<p>When this code runs,
nothing is printed for the first 5 seconds,
although the stream is doing work.
Then the listener is added,
and the first 5 or so events are printed all at once,
since they were buffered by the <code class="language-plaintext highlighter-rouge">StreamController</code>.</p>

<p>To be notified of subscriptions, specify an
<code class="language-plaintext highlighter-rouge">onListen</code> argument when you create the <code class="language-plaintext highlighter-rouge">StreamController</code>.
The <code class="language-plaintext highlighter-rouge">onListen</code> callback is called
when the stream gets its first subscriber.
If you specify an <code class="language-plaintext highlighter-rouge">onCancel</code> callback,
it’s called when the controller loses its last subscriber.
In the preceding example,
<code class="language-plaintext highlighter-rouge">Timer.periodic()</code>
should move to an <code class="language-plaintext highlighter-rouge">onListen</code> handler,
as shown in the next section.</p>

<h3 id="honoring-the-pause-state">
<a class="anchor" href="#honoring-the-pause-state" aria-hidden="true"><span class="octicon octicon-link"></span></a>Honoring the pause state</h3>

<p>Avoid producing events when the listener has requested a pause.
An <code class="language-plaintext highlighter-rouge">async*</code> function automatically pauses at a <code class="language-plaintext highlighter-rouge">yield</code> statement
while the stream subscription is paused.
A <code class="language-plaintext highlighter-rouge">StreamController</code>, on the other hand, buffers events during the pause.
If the code providing the events doesn’t respect the pause,
the size of the buffer can grow indefinitely.
Also, if the listener stops listening soon after pausing,
then the work spent creating the buffer is wasted.</p>

<p>To see what happens without pause support,
try changing the code that uses the stream to the following:</p>

<div class="code-excerpt">
<div class="code-excerpt__code"><pre class="prettyprint lang-dart">void listenWithPause() {
  var counterStream = timedCounter(const Duration(seconds: 1), 15);
  late StreamSubscription&lt;int&gt; subscription;

  subscription = counterStream.listen((int counter) {
    print(counter); // Print an integer every second.
    if (counter == 5) {
      // After 5 ticks, pause for five seconds, then resume.
      subscription.pause(Future.delayed(const Duration(seconds: 5)));
    }
  });
}</pre></div>
</div>

<p>When the five seconds of pause are up,
the events fired during that time are all received at once.
That happens because the stream’s source doesn’t honor pauses
and keeps adding events to the stream.
So the stream buffers the events,
and it then empties its buffer when the stream becomes unpaused.</p>

<p>The following version of <code class="language-plaintext highlighter-rouge">timedCounter()</code>
(from <a href="https://github.com/dart-lang/site-www/blob/main/examples/misc/lib/articles/creating-streams/stream_controller.dart">stream_controller.dart</a>)
implements pause by using the
<code class="language-plaintext highlighter-rouge">onListen</code>, <code class="language-plaintext highlighter-rouge">onPause</code>, <code class="language-plaintext highlighter-rouge">onResume</code>, and <code class="language-plaintext highlighter-rouge">onCancel</code> callbacks
on the <code class="language-plaintext highlighter-rouge">StreamController</code>.</p>

<div class="code-excerpt">
<div class="code-excerpt__code"><pre class="prettyprint lang-dart">Stream&lt;int&gt; timedCounter(Duration interval, [int? maxCount]) {
  late StreamController&lt;int&gt; controller;
  Timer? timer;
  int counter = 0;

  void tick(_) {
    counter++;
    controller.add(counter); // Ask stream to send counter values as event.
    if (counter == maxCount) {
      timer?.cancel();
      controller.close(); // Ask stream to shut down and tell listeners.
    }
  }

  void startTimer() {
    timer = Timer.periodic(interval, tick);
  }

  void stopTimer() {
    timer?.cancel();
    timer = null;
  }

  controller = StreamController&lt;int&gt;(
      onListen: startTimer,
      onPause: stopTimer,
      onResume: startTimer,
      onCancel: stopTimer);

  return controller.stream;
}</pre></div>
</div>

<p>Run this code with the <code class="language-plaintext highlighter-rouge">listenWithPause()</code> function above.
You’ll see that it stops counting while paused,
and it resumes nicely afterwards.</p>

<p>You must use all of the listeners—<code class="language-plaintext highlighter-rouge">onListen</code>,
<code class="language-plaintext highlighter-rouge">onCancel</code>, <code class="language-plaintext highlighter-rouge">onPause</code>, and <code class="language-plaintext highlighter-rouge">onResume</code>—to be
notified of changes in pause state.
The reason is that if the
subscription and pause states both change at the same time,
only the <code class="language-plaintext highlighter-rouge">onListen</code> or <code class="language-plaintext highlighter-rouge">onCancel</code> callback is called.</p>

<h2 id="final-hints">
<a class="anchor" href="#final-hints" aria-hidden="true"><span class="octicon octicon-link"></span></a>Final hints</h2>

<p>When creating a stream without using an async* function,
keep these tips in mind:</p>

<ul>
  <li>
    <p>Be careful when using a synchronous controller—for example,
one created using <code class="language-plaintext highlighter-rouge">StreamController(sync: true)</code>.
When you send an event on an unpaused synchronous controller
(for example, using the <code class="language-plaintext highlighter-rouge">add()</code>, <code class="language-plaintext highlighter-rouge">addError()</code>, or <code class="language-plaintext highlighter-rouge">close()</code> methods defined by
<a href="https://api.dart.dev/stable/dart-async/EventSink-class.html">EventSink</a>),
the event is sent immediately to all listeners on the stream.
<code class="language-plaintext highlighter-rouge">Stream</code> listeners must never be called until
the code that added the listener has fully returned,
and using a synchronous controller at the wrong time can
break this promise and cause good code to fail.
Avoid using synchronous controllers.</p>
  </li>
  <li>
    <p>If you use <code class="language-plaintext highlighter-rouge">StreamController</code>,
the <code class="language-plaintext highlighter-rouge">onListen</code> callback is called before
the <code class="language-plaintext highlighter-rouge">listen</code> call returns the <code class="language-plaintext highlighter-rouge">StreamSubscription</code>.
Don’t let the <code class="language-plaintext highlighter-rouge">onListen</code> callback depend
on the subscription already existing.
For example, in the following code,
an <code class="language-plaintext highlighter-rouge">onListen</code> event fires
(and <code class="language-plaintext highlighter-rouge">handler</code> is called)
before the <code class="language-plaintext highlighter-rouge">subscription</code> variable
has a valid value.</p>

    <div class="code-excerpt">
<div class="code-excerpt__code"><pre class="prettyprint lang-dart">subscription = stream.listen(handler);</pre></div>
</div>
  </li>
  <li>
    <p>The <code class="language-plaintext highlighter-rouge">onListen</code>, <code class="language-plaintext highlighter-rouge">onPause</code>, <code class="language-plaintext highlighter-rouge">onResume</code>, and <code class="language-plaintext highlighter-rouge">onCancel</code>
callbacks defined by <code class="language-plaintext highlighter-rouge">StreamController</code> are
called by the stream when the stream’s listener state changes,
but never during the firing of an event
or during the call of another state change handler.
In those cases, the state change callback is delayed until
the previous callback is complete.</p>
  </li>
  <li>
    <p>Don’t try to implement the <code class="language-plaintext highlighter-rouge">Stream</code> interface yourself.
It’s easy to get the interaction between events, callbacks,
and adding and removing listeners subtly wrong.
Always use an existing stream, possibly from a <code class="language-plaintext highlighter-rouge">StreamController</code>,
to implement the <code class="language-plaintext highlighter-rouge">listen</code> call of a new stream.</p>
  </li>
  <li>
    <p>Although it’s possible to create classes that extend <code class="language-plaintext highlighter-rouge">Stream</code> with
more functionality by extending the <code class="language-plaintext highlighter-rouge">Stream</code> class and
implementing the <code class="language-plaintext highlighter-rouge">listen</code> method and the extra functionality on top,
that is generally not recommended because
it introduces a new type that users have to consider.
Instead of a class that <em>is</em> a <code class="language-plaintext highlighter-rouge">Stream</code> (and more), 
you can often make a class that <em>has</em> a <code class="language-plaintext highlighter-rouge">Stream</code> (and more).</p>
  </li>
</ul>


          

        </div>
      </article>
    </main>
    <footer id="page-footer">
  <div class="footer-section footer-main">
    <a href="/" class="brand" title="Dart">
      <img src="/assets/img/shared/dart/logo+text/horizontal/white.svg" alt="Dart" width="164px">
    </a>
    <div class="footer-social-links">
      <a href="https://medium.com/dartlang" target="_blank" rel="noopener" title="Medium blog" class="no-automatic-external">
        <svg>
          <use href="/assets/img/social/medium.svg#medium"></use>
        </svg>
      </a>
      <a href="https://github.com/dart-lang" target="_blank" rel="noopener" title="GitHub" class="no-automatic-external">
        <svg>
          <use href="/assets/img/social/github.svg#github"></use>
        </svg>
      </a>
      <a href="https://twitter.com/dart_lang" target="_blank" rel="noopener" title="Twitter" class="no-automatic-external">
        <svg>
          <use href="/assets/img/social/twitter.svg#twitter"></use>
        </svg>
      </a>
    </div>
  </div>
  <div class="footer-section footer-tray">
    <div class="footer-licenses">
      Salvo que se indique lo contrario, este sitio está bajo una 
      <a href="https://creativecommons.org/licenses/by/4.0/" class="no-automatic-external">licencia internacional Creative Commons Attribution 4.0</a >, 
      y los ejemplos de código tienen licencia 
      <a href="https://opensource.org/licenses/BSD-3-Clause" class="no-automatic-external">3-Clause BSD License</a>.
    </div>
    <div class="footer-utility-links">
      <ul>
        <li><a href="/terms" title="Terms of use">Términos</a></li>
        <li><a href="https://policies.google.com/privacy" target="_blank" rel="noopener" title="Privacy policy" class="no-automatic-external">Privacidad</a></li>
        <li><a href="/security" title="Security philosophy and practices">Seguridad</a></li>
      </ul>
    </div>
  </div>
</footer>

   
  </body>
</html>
